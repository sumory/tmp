webpackJsonp([2],{772:function(n,s){n.exports={content:["article",["div",{class:"placeholder"}],["p","lor\u662f\u4e00\u4e2a\u6846\u67b6\uff0c \u4e5f\u662f\u4e00\u4e2alibrary\uff0c\u53ef\u4ee5\u50cf\u5176\u4ed6",["code","\u5e93"],"\u6216",["code","\u5de5\u5177\u5305"],"\u4e00\u6837\u4f7f\u7528\u3002\u4e0d\u7528\u5b89\u88c5\uff0c\u76f4\u63a5\u4f7f\u7528\u5b83\u6765\u6784\u5efa\u4e00\u4e2a\u57fa\u4e8eOpenResty\u7684\u9879\u76ee\uff0c\u6b65\u9aa4\u5982\u4e0b\uff1a"],["ul",["li",["p","\u65b0\u5efa\u4e00\u4e2a\u7a7a\u767d\u6587\u4ef6\u5939\u4f5c\u4e3a\u9879\u76ee\u76ee\u5f55\uff0c\u5982mkdir /tmp/myproject"]],["li",["p","\u4e0b\u8f7dlor\uff0cgit clone ",["a",{title:null,href:"https://github.com/sumory/lor"},"https://github.com/sumory/lor"],", \u5c06",["code","lib/lor"],"\u6587\u4ef6\u5939\u62f7\u8d1d\u5728/tmp/myproject\u4e0b\uff0c\u5e76\u53d6\u540d\u4e3a",["code","lor"]]],["li",["p","\u65b0\u5efa\u4e00\u4e2aapp\u6587\u4ef6\u5939\uff0c\u4f5c\u4e3a\u4ee3\u7801\u76ee\u5f55\uff0c \u65b0\u5efaconf\u6587\u4ef6\u5939\u548cnginx.conf\u4f5c\u4e3a\u914d\u7f6e\u6587\u4ef6\uff0c\u65b0\u5efalogs\u6587\u4ef6\u5939\u7528\u4e8e\u5b58\u653e\u65e5\u5fd7\uff0c\u5f53\u524d\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b\uff1a"],["pre",{lang:null,highlighted:'myproject\n\u251c\u2500\u2500 app\n\u251c\u2500\u2500 conf\n\u2502   \u2514\u2500\u2500 nginx<span class="token punctuation">.</span>conf\n\u251c\u2500\u2500 logs\n\u2514\u2500\u2500 lor\n    \u251c\u2500\u2500 index<span class="token punctuation">.</span>lua\n    \u251c\u2500\u2500 version<span class="token punctuation">.</span>lua\n    \u2514\u2500\u2500 lib'},["code","myproject\n\u251c\u2500\u2500 app\n\u251c\u2500\u2500 conf\n\u2502\xa0\xa0 \u2514\u2500\u2500 nginx.conf\n\u251c\u2500\u2500 logs\n\u2514\u2500\u2500 lor\n    \u251c\u2500\u2500 index.lua\n    \u251c\u2500\u2500 version.lua\n    \u2514\u2500\u2500 lib"]]],["li",["p","\u5728app\u6587\u4ef6\u5939\u4e0b\u65b0\u5efa\u4e00\u6587\u4ef6server.lua\u7528\u4e8e\u914d\u7f6elor\u548c\u52a0\u8f7d\u5404\u4e2a\u8def\u7531\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a"],["pre",{lang:"lua",highlighted:'<span class="token keyword">local</span> lor <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"lor.index"</span><span class="token punctuation">)</span>\n<span class="token keyword">local</span> app <span class="token operator">=</span> <span class="token function">lor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n<span class="token comment" spellcheck="true">-- \u6a21\u677f\u914d\u7f6e</span>\napp<span class="token punctuation">:</span><span class="token function">conf</span><span class="token punctuation">(</span><span class="token string">"view enable"</span><span class="token punctuation">,</span> <span class="token keyword">true</span><span class="token punctuation">)</span>\napp<span class="token punctuation">:</span><span class="token function">conf</span><span class="token punctuation">(</span><span class="token string">"view engine"</span><span class="token punctuation">,</span> <span class="token string">"tmpl"</span><span class="token punctuation">)</span>\napp<span class="token punctuation">:</span><span class="token function">conf</span><span class="token punctuation">(</span><span class="token string">"view ext"</span><span class="token punctuation">,</span> <span class="token string">"html"</span><span class="token punctuation">)</span>\napp<span class="token punctuation">:</span><span class="token function">conf</span><span class="token punctuation">(</span><span class="token string">"view layout"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>\napp<span class="token punctuation">:</span><span class="token function">conf</span><span class="token punctuation">(</span><span class="token string">"views"</span><span class="token punctuation">,</span> <span class="token string">"./app/views"</span><span class="token punctuation">)</span>\n\n<span class="token comment" spellcheck="true">-- hello world</span>\napp<span class="token punctuation">:</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"/index"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next<span class="token punctuation">)</span>\n    res<span class="token punctuation">:</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"hello world!"</span><span class="token punctuation">)</span>\n<span class="token keyword">end</span><span class="token punctuation">)</span>\n\n<span class="token comment" spellcheck="true">-- \u9519\u8bef\u5904\u7406\u4e2d\u95f4\u4ef6</span>\napp<span class="token punctuation">:</span><span class="token function">erroruse</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next<span class="token punctuation">)</span>\n    ngx<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ngx<span class="token punctuation">.</span>ERR<span class="token punctuation">,</span> err<span class="token punctuation">)</span>\n\n    <span class="token keyword">if</span> req<span class="token punctuation">:</span><span class="token function">is_found</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">~=</span> <span class="token keyword">true</span> <span class="token keyword">then</span>\n        res<span class="token punctuation">:</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"404! sorry, not found. "</span><span class="token punctuation">)</span>\n    <span class="token keyword">else</span>\n        res<span class="token punctuation">:</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"internal error"</span><span class="token punctuation">)</span>\n    <span class="token keyword">end</span>\n<span class="token keyword">end</span><span class="token punctuation">)</span>\n\n<span class="token keyword">return</span> app'},["code",'local lor = require("lor.index")\nlocal app = lor()\n\n-- \u6a21\u677f\u914d\u7f6e\napp:conf("view enable", true)\napp:conf("view engine", "tmpl")\napp:conf("view ext", "html")\napp:conf("view layout", "")\napp:conf("views", "./app/views")\n\n-- hello world\napp:get("/index", function(req, res, next)\n    res:send("hello world!")\nend)\n\n-- \u9519\u8bef\u5904\u7406\u4e2d\u95f4\u4ef6\napp:erroruse(function(err, req, res, next)\n    ngx.log(ngx.ERR, err)\n\n    if req:is_found() ~= true then\n        res:status(404):send("404! sorry, not found. ")\n    else\n        res:status(500):send("internal error")\n    end\nend)\n\nreturn app']]],["li",["p","\u5728app\u6587\u4ef6\u5939\u4e0b\u65b0\u5efa\u4e00\u6587\u4ef6main.lua\u4f5c\u4e3a\u9879\u76ee\u5165\u53e3\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a"],["pre",{lang:"lua",highlighted:'<span class="token keyword">local</span> app <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"app.server"</span><span class="token punctuation">)</span>\napp<span class="token punctuation">:</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>'},["code",'local app = require("app.server")\napp:run()']]],["li",["p","\u65b0\u5efanginx\u914d\u7f6e\u6587\u4ef6nginx.conf\uff0c\u52a0\u5165\u4ee5\u4e0b\u914d\u7f6e\u3002 \u5373\u5728",["code","lua_package_path"],"\u4e2d\u6307\u5b9alor\u76ee\u5f55",["code","lor"],"\u548c\u6211\u4eec\u81ea\u5df1\u7f16\u5199\u7684\u4ee3\u7801\u6240\u5728\u76ee\u5f55",["code","app"],",\u5e76\u5728",["code","content_by_lua_file"],"\u9636\u6bb5\u6307\u5b9a\u6211\u4eec\u521a\u624d\u7f16\u5199\u7684\u9879\u76ee\u5165\u53e3\u6587\u4ef6\u3002"],["pre",{lang:"sh",highlighted:'# \u6ce8\u610f\u8fd9\u91cc\u53ea\u662f\u4e3a\u4e86\u6f14\u793a\u7684\u6700\u7b80\u914d\u7f6e\uff0c\u5b9e\u9645\u9879\u76ee\u4e2d\u8981\u6839\u636e\u9879\u76ee\u9700\u8981\u81ea\u884c\u914d\u7f6e\npid logs<span class="token operator">/</span>nginx<span class="token punctuation">.</span>pid<span class="token comment" spellcheck="true">;</span>\nworker_processes <span class="token number">4</span><span class="token comment" spellcheck="true">;</span>\nevents {\n    worker_connections <span class="token number">4096</span><span class="token comment" spellcheck="true">;</span>\n}\n\nhttp {\n    lua_package_path "<span class="token punctuation">.</span><span class="token operator">/</span>app<span class="token operator">/</span><span class="token operator">?</span><span class="token punctuation">.</span>lua<span class="token comment" spellcheck="true">;./lor/?.lua;;";</span>\n\n    server {\n        listen <span class="token number">8888</span><span class="token comment" spellcheck="true">;</span>\n\n        access_log logs<span class="token operator">/</span>access<span class="token punctuation">.</span>log combined buffer<span class="token operator">=</span>16k<span class="token comment" spellcheck="true">;</span>\n        error_log logs<span class="token operator">/</span>error<span class="token punctuation">.</span>log<span class="token comment" spellcheck="true">;</span>\n\n        location <span class="token operator">/</span> {\n            content_by_lua_file <span class="token punctuation">.</span><span class="token operator">/</span>app<span class="token operator">/</span>main<span class="token punctuation">.</span>lua<span class="token comment" spellcheck="true">;</span>\n        }\n    }\n}'},["code",'# \u6ce8\u610f\u8fd9\u91cc\u53ea\u662f\u4e3a\u4e86\u6f14\u793a\u7684\u6700\u7b80\u914d\u7f6e\uff0c\u5b9e\u9645\u9879\u76ee\u4e2d\u8981\u6839\u636e\u9879\u76ee\u9700\u8981\u81ea\u884c\u914d\u7f6e\npid logs/nginx.pid;\nworker_processes 4;\nevents {\n    worker_connections 4096;\n}\n\nhttp {\n    lua_package_path "./app/?.lua;./lor/?.lua;;";\n\n    server {\n        listen 8888;\n\n        access_log logs/access.log combined buffer=16k;\n        error_log logs/error.log;\n\n        location / {\n            content_by_lua_file ./app/main.lua;\n        }\n    }\n}']]],["li",["p","\u81f3\u6b64\uff0c\u6240\u6709\u51c6\u5907\u5de5\u4f5c\u5df2\u7ecf\u5b8c\u6210\uff0c\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b"],["pre",{lang:null,highlighted:'myproject\n\u251c\u2500\u2500 app\n\u2502   \u2514\u2500\u2500 main<span class="token punctuation">.</span>lua\n\u251c\u2500\u2500 conf\n\u2502   \u2514\u2500\u2500 nginx<span class="token punctuation">.</span>conf\n\u251c\u2500\u2500 logs\n\u2514\u2500\u2500 lor\n    \u251c\u2500\u2500 index<span class="token punctuation">.</span>lua\n    \u251c\u2500\u2500 version<span class="token punctuation">.</span>lua\n    \u2514\u2500\u2500 lib'},["code","myproject\n\u251c\u2500\u2500 app\n\u2502\xa0\xa0 \u2514\u2500\u2500 main.lua\n\u251c\u2500\u2500 conf\n\u2502\xa0\xa0 \u2514\u2500\u2500 nginx.conf\n\u251c\u2500\u2500 logs\n\u2514\u2500\u2500 lor\n    \u251c\u2500\u2500 index.lua\n    \u251c\u2500\u2500 version.lua\n    \u2514\u2500\u2500 lib"]]],["li",["p","\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u542f\u52a8\u672c\u9879\u76ee"],["pre",{lang:null,highlighted:'nginx <span class="token operator">-</span>c <span class="token punctuation">.</span><span class="token operator">/</span>conf<span class="token operator">/</span>nginx<span class="token punctuation">.</span>conf <span class="token operator">-</span>p `pwd`'},["code","nginx -c ./conf/nginx.conf -p `pwd`"]]]],["p","\u542f\u52a8\u540e\uff0c\u8bbf\u95ee",["a",{title:null,href:"http://localhost:8888/index"},"http://localhost:8888/index"],", \u5c31\u4f1a\u51fa\u73b0\u6211\u4eec\u719f\u6089\u7684",["code","Hello World!"]]],meta:{title:"\u5c06lor\u5f53\u505a\u4e00\u4e2a\u5e93\u4f7f\u7528",type:"\u9ad8\u7ea7",order:205,filename:"docs/use_as_lib.zh-CN.md"},toc:["ul"]}}});